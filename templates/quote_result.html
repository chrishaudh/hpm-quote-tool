<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Your Quote – Hawkins Pro Mounting</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      max-width: 700px;
      margin: 0 auto;
      padding: 1.5rem;
      background-color: #f7f7f7;
      color: #111827;
    }
    h1 {
      font-size: 1.6rem;
      margin-bottom: 0.5rem;
    }
    p.lead {
      margin-bottom: 1.25rem;
      color: #4b5563;
    }
    .card {
      background: #ffffff;
      border-radius: 0.75rem;
      padding: 1.25rem 1.5rem;
      box-shadow: 0 4px 14px rgba(0,0,0,0.05);
      margin-bottom: 1.25rem;
    }
    h2.section-title {
      font-size: 1.1rem;
      margin: 0 0 0.5rem;
    }
    .summary-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.75rem;
      font-size: 0.95rem;
      padding: 0.25rem 0;
    }
    .summary-row.total {
      font-weight: 700;
      font-size: 1.05rem;
      border-top: 1px solid #e5e7eb;
      margin-top: 0.5rem;
      padding-top: 0.5rem;
    }
    .summary-label {
      color: #4b5563;
    }
    .summary-value {
      font-weight: 600;
    }
    .muted {
      font-size: 0.85rem;
      color: #6b7280;
    }
    .pill {
      display: inline-flex;
      align-items: center;
      padding: 0.2rem 0.6rem;
      border-radius: 999px;
      font-size: 0.8rem;
      background: #eff6ff;
      color: #1d4ed8;
      margin-left: 0.25rem;
    }
    .line-items {
      margin-top: 0.5rem;
      border-top: 1px solid #e5e7eb;
      padding-top: 0.5rem;
    }
    .line-item-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.75rem;
      font-size: 0.9rem;
      padding: 0.15rem 0;
    }
    .line-item-label {
      color: #374151;
    }
    .line-item-value {
      font-weight: 600;
    }
    .line-item-negative {
      color: #b91c1c;
    }
    .line-item-sub {
      font-size: 0.8rem;
      color: #6b7280;
    }

    .cta-card {
      background: #ffffff;
      border-radius: 0.75rem;
      padding: 1.25rem 1.5rem;
      box-shadow: 0 4px 14px rgba(0,0,0,0.05);
    }
    .cta-card p {
      margin: 0.15rem 0;
      font-size: 0.9rem;
      color: #4b5563;
    }
    .cta-card p strong {
      color: #111827;
    }

    .cta-buttons {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      margin-top: 1.25rem;
    }
    .cta-buttons a {
      display: block;
      width: 100%;
      text-align: center;
      padding: 0.85rem 1.25rem;
      border-radius: 999px;
      font-weight: 600;
      text-decoration: none;
      box-sizing: border-box;
      font-size: 1rem;
    }
    .btn-primary {
      background: #2563eb;
      color: #ffffff;
    }
    .btn-primary:hover {
      background: #1d4ed8;
    }
    .btn-secondary {
      background: #e5e7eb;
      color: #111827;
    }
    .btn-secondary:hover {
      background: #d1d5db;
    }

    @media (max-width: 640px) {
      body {
        padding: 1rem;
      }
      .card,
      .cta-card {
        padding: 1rem 1.1rem;
      }
    }
  </style>
</head>
<body>
  <h1>Your Estimate</h1>
  <p class="lead">
    Here’s a rough estimate for your install based on the details you entered.
    Final pricing may adjust slightly after we confirm everything on-site.
  </p>

  <!-- Summary Card -->
  <div class="card">
    <h2 class="section-title">
      Estimate Summary
      {% if num_services and num_services > 1 %}
        <span class="pill">{{ num_services }} services in one visit</span>
      {% endif %}
    </h2>

    <div class="summary-row">
      <span class="summary-label">Subtotal before tax</span>
      <span class="summary-value">${{ '%.2f' % subtotal_before_tax }}</span>
    </div>
    <div class="summary-row">
      <span class="summary-label">Estimated tax ({{ '%.1f' % (tax_rate * 100) }}%)</span>
      <span class="summary-value">${{ '%.2f' % tax_amount }}</span>
    </div>
    <div class="summary-row total">
      <span class="summary-label">Estimated total</span>
      <span class="summary-value">${{ '%.2f' % estimated_total_with_tax }}</span>
    </div>

    {% set li = line_items or {} %}
    {% if li.multi_service_discount is defined and li.multi_service_discount != 0 %}
      <p class="muted" style="margin-top:0.5rem;">
        A <strong>multi-service discount</strong> has been applied for booking multiple
        services in one visit.
      </p>
    {% endif %}

    <p class="muted" style="margin-top:0.4rem;">
      This estimate is based on your inputs and typical conditions.
      You’ll be able to confirm final details before or during the visit.
    </p>
  </div>

  <!-- Line Items Card -->
  <div class="card">
    <h2 class="section-title">What’s Included in This Estimate</h2>

    <div class="line-items">
      {% set li = line_items or {} %}

      {# TV mounting + removal #}
      {% if li.tv_total is defined and li.tv_total != 0 %}
        <div class="line-item-row">
          <span class="line-item-label">
            TV mounting
            {% if tv_size and tv_size > 0 %}
              ({{ tv_size }}")
            {% endif %}
          </span>
          <span class="line-item-value">${{ '%.2f' % li.tv_total }}</span>
        </div>
      {% endif %}

      {% if li.tv_removal_total is defined and li.tv_removal_total != 0 %}
        <div class="line-item-row">
          <span class="line-item-label">
            Remove existing TV / bracket / shelf
            {% if tv_shelf_removal_count is defined and tv_shelf_removal_count %}
              ({{ tv_shelf_removal_count }} item{% if tv_shelf_removal_count != 1 %}s{% endif %})
            {% endif %}
          </span>
          <span class="line-item-value">${{ '%.2f' % li.tv_removal_total }}</span>
        </div>
      {% endif %}

      {# Picture & art hanging + large item surcharge #}
      {% if li.picture_total is defined and li.picture_total != 0 %}
        <div class="line-item-row">
          <span class="line-item-label">
            Picture &amp; art hanging
            {% if picture_count and picture_count > 0 %}
              ({{ picture_count }} piece{% if picture_count != 1 %}s{% endif %})
            {% endif %}
          </span>
          <span class="line-item-value">${{ '%.2f' % li.picture_total }}</span>
        </div>
      {% endif %}

      {% if li.picture_large_art_fee is defined and li.picture_large_art_fee != 0 %}
        <div class="line-item-row">
          <span class="line-item-label">
            Large item surcharge
            {% if large_picture_count is defined and large_picture_count %}
              ({{ large_picture_count }} piece{% if large_picture_count != 1 %}s{% endif %} &gt; 6ft)
            {% endif %}
          </span>
          <span class="line-item-value">${{ '%.2f' % li.picture_large_art_fee }}</span>
        </div>
      {% endif %}

      {# Floating shelves + removal #}
      {% if li.shelves_total is defined and li.shelves_total != 0 %}
        <div class="line-item-row">
          <span class="line-item-label">
            Floating shelves
            {% if shelves_count is defined and shelves_count and shelves_count > 0 %}
              ({{ shelves_count }} shelf{% if shelves_count != 1 %}s{% endif %})
            {% endif %}
          </span>
          <span class="line-item-value">${{ '%.2f' % li.shelves_total }}</span>
        </div>
      {% endif %}

      {% if li.floating_removal_total is defined and li.floating_removal_total != 0 %}
        <div class="line-item-row">
          <span class="line-item-label">
            Remove floating shelves
            {% if floating_shelf_removal_count is defined and floating_shelf_removal_count %}
              ({{ floating_shelf_removal_count }} shelf{% if floating_shelf_removal_count != 1 %}s{% endif %})
            {% endif %}
          </span>
          <span class="line-item-value">${{ '%.2f' % li.floating_removal_total }}</span>
        </div>
      {% endif %}

      {# Closet shelving + removal #}
      {% if li.closet_total is defined and li.closet_total != 0 %}
        <div class="line-item-row">
          <span class="line-item-label">
            Closet shelving / organizers
            {% if closet_shelf_count is defined and closet_shelf_count and closet_shelf_count > 0 %}
              ({{ closet_shelf_count }} shelf{% if closet_shelf_count != 1 %}s{% endif %})
            {% endif %}
            {% if closet_needs_materials %}
              <span class="line-item-sub"> – materials purchase requested</span>
            {% endif %}
          </span>
          <span class="line-item-value">${{ '%.2f' % li.closet_total }}</span>
        </div>
      {% endif %}

      {% if li.closet_removal_total is defined and li.closet_removal_total != 0 %}
        <div class="line-item-row">
          <span class="line-item-label">
            Remove closet shelves
            {% if closet_shelf_removal_count is defined and closet_shelf_removal_count %}
              ({{ closet_shelf_removal_count }} shelf{% if closet_shelf_removal_count != 1 %}s{% endif %})
            {% endif %}
          </span>
          <span class="line-item-value">${{ '%.2f' % li.closet_removal_total }}</span>
        </div>
      {% endif %}

      {# Curtains / Blinds / Decor #}
      {% if li.decor_total is defined and li.decor_total != 0 %}
        <div class="line-item-row">
          <span class="line-item-label">
            Curtains / blinds / decor
            {% if decor_count and decor_count > 0 %}
              ({{ decor_count }} piece{% if decor_count != 1 %}s{% endif %})
            {% endif %}
          </span>
          <span class="line-item-value">${{ '%.2f' % li.decor_total }}</span>
        </div>
      {% endif %}

      {# Combined removal total (informational) #}
      {% if li.removal_total is defined and li.removal_total != 0 %}
        <div class="line-item-row">
          <span class="line-item-label">
            Total removal labor
          </span>
          <span class="line-item-value">${{ '%.2f' % li.removal_total }}</span>
        </div>
      {% endif %}

      {# Same-day / after-hours (if ever used in quote) #}
      {% if li.same_day_surcharge is defined and li.same_day_surcharge != 0 %}
        <div class="line-item-row">
          <span class="line-item-label">Same-day preference surcharge</span>
          <span class="line-item-value">${{ '%.2f' % li.same_day_surcharge }}</span>
        </div>
      {% endif %}

      {% if li.after_hours_surcharge is defined and li.after_hours_surcharge != 0 %}
        <div class="line-item-row">
          <span class="line-item-label">After-hours preference surcharge</span>
          <span class="line-item-value">${{ '%.2f' % li.after_hours_surcharge }}</span>
        </div>
      {% endif %}

      {# Multi-service discount #}
      {% if li.multi_service_discount is defined and li.multi_service_discount != 0 %}
        <div class="line-item-row">
          <span class="line-item-label">Multi-service discount</span>
          <span class="line-item-value line-item-negative">
            ${{ '%.2f' % li.multi_service_discount }}
          </span>
        </div>
      {% endif %}
    </div>

    <p class="muted" style="margin-top:0.5rem;">
      All numbers are approximate and based on standard conditions. If something
      unusual comes up (very high ceilings, special wall types, etc.), we’ll discuss
      any adjustments with you before moving forward.
    </p>
  </div>

  <!-- Flags / Notes Card -->
  <div class="card">
    <h2 class="section-title">Job Notes &amp; Preferences</h2>

    <div class="line-items">
      {% if gallery_wall is defined and gallery_wall %}
        <div class="line-item-row">
          <span class="line-item-label">Gallery wall planned</span>
          <span class="line-item-sub">Layout and spacing may take additional planning time.</span>
        </div>
      {% endif %}

      {% if ladder_required is defined and ladder_required %}
        <div class="line-item-row">
          <span class="line-item-label">Ladder required</span>
          <span class="line-item-sub">We’ll plan for higher reach or tall ceilings.</span>
        </div>
      {% endif %}

      {% if contact_method is defined and contact_method %}
        <div class="line-item-row">
          <span class="line-item-label">Preferred contact method</span>
          <span class="line-item-value">
            {{ contact_method | capitalize }}
          </span>
        </div>
      {% endif %}

      {% if building_notes is defined and building_notes %}
        <div class="line-item-row" style="align-items:flex-start;">
          <span class="line-item-label">Parking / building notes</span>
          <span class="line-item-sub" style="max-width:360px;">{{ building_notes }}</span>
        </div>
      {% endif %}

      {% if (not (gallery_wall is defined and gallery_wall)) 
            and (not (ladder_required is defined and ladder_required)) 
            and (not (contact_method is defined and contact_method)) 
            and (not (building_notes is defined and building_notes)) %}
        <p class="muted">
          No special notes were added. If you have gate codes, parking details, or
          anything else I should know, feel free to email or mention it when booking.
        </p>
      {% endif %}
    </div>
  </div>

  <!-- CTA Card -->
  <div class="cta-card">
    <h2 class="section-title">Next Steps</h2>
    <p>
      <strong>Ready to go?</strong> You can lock in a time on the schedule right now.
    </p>
    <p>
      Prefer to double-check something first?
      You can send a quick question by email before you book.
    </p>

    <div class="cta-buttons">
      <a href="{{ booking_url }}" class="btn-primary">
        Book This Install
      </a>

      <a href="mailto:{{ contact_email or 'hawkinspromounting@gmail.com' }}?subject=Question%20about%20my%20quote"
         class="btn-secondary">
        Ask a Question First
      </a>
    </div>
  </div>
</body>
</html>
